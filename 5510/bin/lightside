#!/usr/bin/env bash

# This only works with nvim and https://github.com/mhinz/neovim-remote installed.
# It can work with vim that is compiled with +clientserver and replaceing nvr with vim.

has_display() {
    [[ -n "$DISPLAY" ]]
}

main() {
    if has_display; then
        ln -sf "$HOME/.vim/light.vim" "$HOME/.vim/lightOrDark.vim"
        for s in $(nvr --serverlist)
        do
            nvr --servername $s --remote-send '<Esc>:source ${HOME}/.config/nvim/init.vim<CR>'
        done

        ln -sf "$HOME/.config/termite/light" "$HOME/.config/termite/config"
        killall -USR1 termite

        ln -sf  "$HOME/.config/i3/light" "$HOME/.config/i3/config"
        i3-msg restart
    fi
}

main
